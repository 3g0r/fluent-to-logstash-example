<source>
  @type  forward
  @id    input1
  @label @mainstream
  port  24224
  time_key @timestamp
  time_format "%Y-%m-%d %H:%M:%S.%L%Z"
</source>

<label @mainstream>
  # concat multiline logs
  <filter docker.**>
    @type concat
    key log
    flush_interval 10
    stream_identity_key container_name
    multiline_start_regexp /^--/
  </filter>

  # create timestamp
  <filter docker.**>
    @type record_transformer
    enable_ruby
    <record>
      timestamp ${ Time.now.utc.iso8601(3) }
    </record>
  </filter>

  <match docker.**>
    @type gelf
    host logstash
    port 4000
    protocol udp
  </match>

</label>


